import{A as D}from"./AppLoader.156f2d92.js";import{t as k}from"./time.a44078dd.js";import{_ as I,G as $,r as i,t as C,o as t,c as a,F as x,P as M,V as S,Q as g,f as n,u as y,p as R,g as T,b as v,D as B,a as V,e as w,d as L,w as N,h as A}from"./app.68a49c4f.js";const F=d=>(R("data-v-51d21b5f"),d=d(),T(),d),H={key:0,class:"team-list"},z=F(()=>v("div",{class:"team-list__header"},"\u0412\u044B\u0431\u0435\u0440\u0438\u0442\u0435 \u043A\u043E\u043C\u0430\u043D\u0434\u0443",-1)),E=["onClick"],G={key:1,class:"team-notification"},P={key:2,class:"btn btn-disable btn-settings-280"},Q={__name:"TeamStageReg",props:["status","stage"],emits:["reg","cancel"],setup(d,{emit:p}){const u=d,e=$(),f=e.getters["auth/user"],l=i(u.status),o=i([]),_=i(null),r=i({});i({}),C(async()=>{const s=await axios.get("/api/team/capitan");if(o.value=s.data.teams,u.status){const b=await axios.get(`/api/stage/${u.stage}/reg-info`);r.value=b.data.team}});const c=async()=>{try{const s=await axios.post("/api/stage/accept",{stage_id:u.stage,team_id:_.value});s.data.result?(p("reg"),r.value=s.data.team,l.value=!0,e.dispatch("notification/displayMessage",{value:"\u041A\u043E\u043C\u0430\u043D\u0434\u0430 \u0437\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043E\u0432\u0430\u043D\u0430",type:"primary"})):e.dispatch("notification/displayMessage",{value:s.data.msg,type:"error"})}catch(s){console.log(s.message),e.dispatch("notification/displayMessage",{value:s.message,type:"error"})}},h=async()=>{try{(await axios.post("/api/stage/cancel",{stage_id:u.stage,team_id:r.value.id})).data.result&&(p("cancel"),_.value=null,r.value={},l.value=!1,e.dispatch("notification/displayMessage",{value:"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044F \u043E\u0442\u043C\u0435\u043D\u0435\u043D\u0430",type:"primary"}))}catch(s){console.log(s.message)}};return(s,b)=>(t(),a(x,null,[o.value.length>0&&!l.value?(t(),a("div",H,[z,(t(!0),a(x,null,M(o.value,m=>(t(),a("div",{class:S(["team-list__item",{"team-list__item-select":m.id===_.value}]),key:m.id,onClick:Z=>_.value=m.id},g(m.name),11,E))),128)),_.value!==null?(t(),a("div",{key:0,class:"btn btn-default",onClick:c},"\u0417\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043E\u0432\u0430\u0442\u044C")):n("",!0)])):n("",!0),o.value.length===0&&!l.value?(t(),a("div",G," \u0412\u044B \u043D\u0435 \u0441\u043E\u0441\u0442\u043E\u0438\u0442\u0435 \u0432 \u043A\u043E\u043C\u0430\u043D\u0434\u0435 \u0438\u043B\u0438 \u043D\u0435 \u044F\u0432\u043B\u044F\u0435\u0442\u0435\u0441\u044C \u043A\u0430\u043F\u0438\u0442\u0430\u043D\u043E\u043C ")):n("",!0),l.value&&r.value?(t(),a("div",P,'\u041A\u043E\u043C\u0430\u043D\u0434\u0430 "'+g(r.value.name)+'" \u0437\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043E\u0432\u0430\u043D\u0430',1)):n("",!0),l.value&&r.value.user_id===y(f).id?(t(),a("div",{key:3,class:"btn btn-default",onClick:h},"\u041E\u0442\u043A\u0430\u0437\u0430\u0442\u044C\u0441\u044F")):n("",!0)],64))}},U=I(Q,[["__scopeId","data-v-51d21b5f"]]),j={class:"dash-stage"},q={class:"dash-stage__header"},J={class:"dash-stage__tournament"},K={key:0,class:"user-stage__participant"},O={class:"dash-stage__date"},W=["innerHTML"],X={key:2,class:"btn btn-disable btn-settings-280"},Y={key:5,class:"btn btn-disable btn-settings-280"},ae={__name:"AppDashStages",props:["stage"],setup(d){const p=d,u=()=>{o.value=new Date};$();const e=i(p.stage),f=i(!1),l=i(!1),o=i();C(()=>{u()});const _=setInterval(u,1e4);return B(()=>{clearInterval(_)}),(r,c)=>{const h=V("router-link");return t(),a("div",j,[f.value?(t(),w(D,{key:0})):n("",!0),v("div",q,[L(h,{to:`/dashboard/stage/${e.value.id}`,class:"dash-stage__title"},{default:N(()=>[A(g(e.value.title),1)]),_:1},8,["to"]),v("div",J,g(e.value.tournament),1),e.value.users_exists?(t(),a("div",K,"\u0412\u044B \u0443\u0447\u0430\u0441\u0442\u0432\u0443\u0435\u0442\u0435")):n("",!0)]),v("div",O,[v("span",null,"\u041D\u0430\u0447\u0430\u043B\u043E \u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u0438: "+g(y(k)(e.value.register_start)),1),v("span",null,"\u041E\u043A\u043E\u043D\u0447\u0430\u043D\u0438\u0435 \u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u0438: "+g(y(k)(e.value.register_end)),1)]),e.value.excerpt?(t(),a("div",{key:1,class:"user-stage__excerpt content",innerHTML:e.value.excerpt},null,8,W)):n("",!0),new Date(e.value.register_start)>o.value?(t(),a("div",X," \u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044F \u043D\u0435 \u043D\u0430\u0447\u0430\u043B\u0430\u0441\u044C ")):n("",!0),l.value||e.value.users_exists?(t(),w(U,{key:3,stage:e.value.id,status:e.value.users_exists,onReg:c[0]||(c[0]=s=>e.value.users_exists=!0),onCancel:c[1]||(c[1]=s=>{l.value=!1,e.value.users_exists=!1})},null,8,["stage","status"])):n("",!0),e.value.status==="active"&&new Date(e.value.register_start)<o.value&&!l.value&&!e.value.users_exists?(t(),a("div",{key:4,class:S(["btn","btn-settings-280","btn-default"]),onClick:c[2]||(c[2]=s=>l.value=!0)},"\u041F\u0440\u0438\u043D\u044F\u0442\u044C \u0443\u0447\u0430\u0441\u0442\u0438\u0435")):n("",!0),new Date(e.value.register_end)<o.value?(t(),a("div",Y," \u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044F \u0437\u0430\u043A\u043E\u043D\u0447\u0438\u043B\u0430\u0441\u044C ")):n("",!0)])}}};export{ae as _};
