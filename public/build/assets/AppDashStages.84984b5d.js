import{A as I}from"./logo.b439285c.js";import{t as k}from"./time.a44078dd.js";import{_ as D,u as $,r as i,i as C,o as s,c as a,F as x,P as R,V as S,Q as g,f as l,q as h,I as B,J as M,b as v,G as T,a as V,e as w,d as N,w as A,g as F}from"./app.786ab8d6.js";const L=d=>(B("data-v-51d21b5f"),d=d(),M(),d),q={key:0,class:"team-list"},z=L(()=>v("div",{class:"team-list__header"},"\u0412\u044B\u0431\u0435\u0440\u0438\u0442\u0435 \u043A\u043E\u043C\u0430\u043D\u0434\u0443",-1)),E=["onClick"],G={key:1,class:"team-notification"},J={key:2,class:"btn btn-disable btn-settings-280"},P={__name:"TeamStageReg",props:["status","stage"],emits:["reg","cancel"],setup(d,{emit:p}){const u=d,e=$(),f=e.getters["auth/user"],n=i(u.status),o=i([]),_=i(null),r=i({});i({}),C(async()=>{const t=await axios.get("/api/team/capitan");if(o.value=t.data.teams,u.status){const b=await axios.get(`/api/stage/${u.stage}/reg-info`);r.value=b.data.team}});const c=async()=>{try{const t=await axios.post("/api/stage/accept",{stage_id:u.stage,team_id:_.value});t.data.result?(p("reg"),r.value=t.data.team,n.value=!0,e.dispatch("notification/displayMessage",{value:"\u041A\u043E\u043C\u0430\u043D\u0434\u0430 \u0437\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043E\u0432\u0430\u043D\u0430",type:"primary"})):e.dispatch("notification/displayMessage",{value:t.data.msg,type:"error"})}catch(t){console.log(t.message),e.dispatch("notification/displayMessage",{value:t.message,type:"error"})}},y=async()=>{try{(await axios.post("/api/stage/cancel",{stage_id:u.stage,team_id:r.value.id})).data.result&&(p("cancel"),_.value=null,r.value={},n.value=!1,e.dispatch("notification/displayMessage",{value:"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044F \u043E\u0442\u043C\u0435\u043D\u0435\u043D\u0430",type:"primary"}))}catch(t){console.log(t.message)}};return(t,b)=>(s(),a(x,null,[o.value.length>0&&!n.value?(s(),a("div",q,[z,(s(!0),a(x,null,R(o.value,m=>(s(),a("div",{class:S(["team-list__item",{"team-list__item-select":m.id===_.value}]),key:m.id,onClick:Y=>_.value=m.id},g(m.name),11,E))),128)),_.value!==null?(s(),a("div",{key:0,class:"btn btn-default",onClick:c},"\u0417\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043E\u0432\u0430\u0442\u044C")):l("",!0)])):l("",!0),o.value.length===0&&!n.value?(s(),a("div",G," \u0412\u044B \u043D\u0435 \u0441\u043E\u0441\u0442\u043E\u0438\u0442\u0435 \u0432 \u043A\u043E\u043C\u0430\u043D\u0434\u0435 \u0438\u043B\u0438 \u043D\u0435 \u044F\u0432\u043B\u044F\u0435\u0442\u0435\u0441\u044C \u043A\u0430\u043F\u0438\u0442\u0430\u043D\u043E\u043C ")):l("",!0),n.value&&r.value?(s(),a("div",J,'\u041A\u043E\u043C\u0430\u043D\u0434\u0430 "'+g(r.value.name)+'" \u0437\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043E\u0432\u0430\u043D\u0430',1)):l("",!0),n.value&&r.value.user_id===h(f).id?(s(),a("div",{key:3,class:"btn btn-default",onClick:y},"\u041E\u0442\u043A\u0430\u0437\u0430\u0442\u044C\u0441\u044F")):l("",!0)],64))}},Q=D(P,[["__scopeId","data-v-51d21b5f"]]),U={class:"dash-stage"},j={class:"dash-stage__header"},H={class:"dash-stage__tournament"},K={key:0,class:"user-stage__participant"},O={class:"dash-stage__date"},W={key:1,class:"btn btn-disable btn-settings-280"},X={key:4,class:"btn btn-disable btn-settings-280"},se={__name:"AppDashStages",props:["stage"],setup(d){const p=d,u=()=>{o.value=new Date};$();const e=i(p.stage),f=i(!1),n=i(!1),o=i();C(()=>{u()});const _=setInterval(u,1e4);return T(()=>{clearInterval(_)}),(r,c)=>{const y=V("router-link");return s(),a("div",U,[f.value?(s(),w(I,{key:0})):l("",!0),v("div",j,[N(y,{to:`/dashboard/stage/${e.value.id}`,class:"dash-stage__title"},{default:A(()=>[F(g(e.value.title),1)]),_:1},8,["to"]),v("div",H,g(e.value.tournament),1),e.value.users_exists?(s(),a("div",K,"\u0412\u044B \u0443\u0447\u0430\u0441\u0442\u0432\u0443\u0435\u0442\u0435")):l("",!0)]),v("div",O,[v("span",null,"\u041D\u0430\u0447\u0430\u043B\u043E \u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u0438: "+g(h(k)(e.value.register_start)),1),v("span",null,"\u041E\u043A\u043E\u043D\u0447\u0430\u043D\u0438\u0435 \u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u0438: "+g(h(k)(e.value.register_end)),1)]),new Date(e.value.register_start)>o.value?(s(),a("div",W," \u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044F \u043D\u0435 \u043D\u0430\u0447\u0430\u043B\u0430\u0441\u044C ")):l("",!0),n.value||e.value.users_exists?(s(),w(Q,{key:2,stage:e.value.id,status:e.value.users_exists,onReg:c[0]||(c[0]=t=>e.value.users_exists=!0),onCancel:c[1]||(c[1]=t=>{n.value=!1,e.value.users_exists=!1})},null,8,["stage","status"])):l("",!0),e.value.status==="active"&&new Date(e.value.register_start)<o.value&&!n.value&&!e.value.users_exists?(s(),a("div",{key:3,class:S(["btn","btn-settings-280","btn-default"]),onClick:c[2]||(c[2]=t=>n.value=!0)},"\u041F\u0440\u0438\u043D\u044F\u0442\u044C \u0443\u0447\u0430\u0441\u0442\u0438\u0435")):l("",!0),new Date(e.value.register_end)<o.value?(s(),a("div",X," \u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044F \u0437\u0430\u043A\u043E\u043D\u0447\u0438\u043B\u0430\u0441\u044C ")):l("",!0)])}}};export{se as _};
