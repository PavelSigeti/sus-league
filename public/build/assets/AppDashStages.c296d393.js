import{A as I}from"./logo.25bb1523.js";import{t as m}from"./time.a44078dd.js";import{_ as R,u as w,r as u,i as C,o as s,c as a,F as x,P as M,V as S,Q as p,f as o,q as v,I as B,J as T,b as g,G as V,a as A,e as $,d as D,w as N,g as L}from"./app.19c2e788.js";const E=d=>(B("data-v-51d21b5f"),d=d(),T(),d),F={key:0,class:"team-list"},U=E(()=>g("div",{class:"team-list__header"},"\u0412\u044B\u0431\u0435\u0440\u0438\u0442\u0435 \u043A\u043E\u043C\u0430\u043D\u0434\u0443",-1)),q=["onClick"],z={key:1,class:"team-notification"},G={key:2,class:"btn btn-disable btn-settings-280"},J={__name:"TeamStageReg",props:["status","stage"],emits:["reg","cancel"],setup(d,{emit:f}){const r=d,e=w(),h=e.getters["auth/user"],n=u(r.status),i=u([]),_=u(null),l=u({});u({}),C(async()=>{const t=await axios.get("/api/team/capitan");if(i.value=t.data.teams,r.status){const k=await axios.get(`/api/stage/${r.stage}/reg-info`);l.value=k.data.team}});const c=async()=>{try{const t=await axios.post("/api/stage/accept",{stage_id:r.stage,team_id:_.value});t.data.result?(f("reg"),l.value=t.data.team,n.value=!0,e.dispatch("notification/displayMessage",{value:"\u041A\u043E\u043C\u0430\u043D\u0434\u0430 \u0437\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043E\u0432\u0430\u043D\u0430",type:"primary"})):e.dispatch("notification/displayMessage",{value:t.data.msg,type:"error"})}catch(t){console.log(t.message),e.dispatch("notification/displayMessage",{value:t.message,type:"error"})}},b=async()=>{try{(await axios.post("/api/stage/cancel",{stage_id:r.stage,team_id:l.value.id})).data.result&&(f("cancel"),_.value=null,l.value={},n.value=!1,e.dispatch("notification/displayMessage",{value:"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044F \u043E\u0442\u043C\u0435\u043D\u0435\u043D\u0430",type:"primary"}))}catch(t){console.log(t.message)}};return(t,k)=>(s(),a(x,null,[i.value.length>0&&!n.value?(s(),a("div",F,[U,(s(!0),a(x,null,M(i.value,y=>(s(),a("div",{class:S(["team-list__item",{"team-list__item-select":y.id===_.value}]),key:y.id,onClick:X=>_.value=y.id},p(y.name),11,q))),128)),_.value!==null?(s(),a("div",{key:0,class:"btn btn-default",onClick:c},"\u0417\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043E\u0432\u0430\u0442\u044C")):o("",!0)])):o("",!0),i.value.length===0&&!n.value?(s(),a("div",z," \u0412\u044B \u043D\u0435 \u0441\u043E\u0441\u0442\u043E\u0438\u0442\u0435 \u0432 \u043A\u043E\u043C\u0430\u043D\u0434\u0435 \u0438\u043B\u0438 \u043D\u0435 \u044F\u0432\u043B\u044F\u0435\u0442\u0435\u0441\u044C \u043A\u0430\u043F\u0438\u0442\u0430\u043D\u043E\u043C ")):o("",!0),n.value&&l.value?(s(),a("div",G,'\u041A\u043E\u043C\u0430\u043D\u0434\u0430 "'+p(l.value.name)+'" \u0437\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043E\u0432\u0430\u043D\u0430',1)):o("",!0),n.value&&l.value.user_id===v(h).id?(s(),a("div",{key:3,class:"btn btn-default",onClick:b},"\u041E\u0442\u043A\u0430\u0437\u0430\u0442\u044C\u0441\u044F")):o("",!0)],64))}},P=R(J,[["__scopeId","data-v-51d21b5f"]]),Q={class:"dash-stage"},Z={class:"dash-stage__header"},j={class:"dash-stage__tournament"},H={key:0,class:"user-stage__participant"},K={class:"dash-stage__date"},O={key:1,class:"btn btn-disable btn-settings-280"},W={key:4,class:"btn btn-disable btn-settings-280"},se={__name:"AppDashStages",props:["stage"],setup(d){const f=d,r=()=>{const l=new Date().toLocaleString("ru-RU",{timeZone:"Europe/Moscow"}).split(",");i.value=`${l[0]} ${l[1]}`};w();const e=u(f.stage),h=u(!1),n=u(!1),i=u();C(()=>{r()});const _=setInterval(r,1e3);return V(()=>{clearInterval(_)}),(l,c)=>{const b=A("router-link");return s(),a("div",Q,[h.value?(s(),$(I,{key:0})):o("",!0),g("div",Z,[D(b,{to:`/dashboard/stage/${e.value.id}`,class:"dash-stage__title"},{default:N(()=>[L(p(e.value.title),1)]),_:1},8,["to"]),g("div",j,p(e.value.tournament),1),e.value.users_exists?(s(),a("div",H,"\u0412\u044B \u0443\u0447\u0430\u0441\u0442\u0432\u0443\u0435\u0442\u0435")):o("",!0)]),g("div",K,[g("span",null,"\u041D\u0430\u0447\u0430\u043B\u043E \u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u0438: "+p(v(m)(e.value.register_start)),1),g("span",null,"\u041E\u043A\u043E\u043D\u0447\u0430\u043D\u0438\u0435 \u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u0438: "+p(v(m)(e.value.register_end)),1)]),v(m)(e.value.register_start)>i.value?(s(),a("div",O," \u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044F \u043D\u0435 \u043D\u0430\u0447\u0430\u043B\u0430\u0441\u044C ")):o("",!0),n.value||e.value.users_exists?(s(),$(P,{key:2,stage:e.value.id,status:e.value.users_exists,onReg:c[0]||(c[0]=t=>e.value.users_exists=!0),onCancel:c[1]||(c[1]=t=>{n.value=!1,e.value.users_exists=!1})},null,8,["stage","status"])):o("",!0),e.value.status==="active"&&v(m)(e.value.register_end)>i.value&&!n.value&&!e.value.users_exists?(s(),a("div",{key:3,class:S(["btn","btn-settings-280","btn-default"]),onClick:c[2]||(c[2]=t=>n.value=!0)},"\u041F\u0440\u0438\u043D\u044F\u0442\u044C \u0443\u0447\u0430\u0441\u0442\u0438\u0435")):o("",!0),v(m)(e.value.register_end)<i.value?(s(),a("div",W," \u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044F \u0437\u0430\u043A\u043E\u043D\u0447\u0438\u043B\u0430\u0441\u044C ")):o("",!0)])}}};export{se as _};
