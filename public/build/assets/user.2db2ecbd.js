import{A as B}from"./AppHeader.b0a65ded.js";import{H as D,r as c,X as b,o as t,c as l,b as e,R as i,f as g,a5 as N,G as V,h,_ as z,t as P,F as A,Q as G,e as I,p as R,g as T,J as F,d as S,w as J}from"./app.18474491.js";import{s as k}from"./statusText.92586763.js";import"./AppLoader.f92e7638.js";const L={class:"file-upload"},W={key:0,class:"img-container"},H={class:"current-img"},M=["href"],j={key:0,class:"ri-file-pdf-2-line"},O=["src"],Q=e("i",{class:"ri-delete-bin-line"},null,-1),X=[Q],q={key:1,class:"single-img"},K=e("div",{class:"form-control-title"},null,-1),Y=["for"],Z=e("div",{class:"file-upload-label"},[e("div",{class:"file-upload-label__select"},[e("i",{class:"ri-folder-upload-line"}),h(" \u0412\u044B\u0431\u0440\u0430\u0442\u044C \u0444\u0430\u0439\u043B ")])],-1),ee=[Z],se=e("i",{class:"ri-restart-fill"},null,-1),te=[se],ae=["id"],le={key:2,class:"error-msg"},ie={class:"file-status"},oe={__name:"UserSpecificFileAdmin",props:["document","file"],setup(d){const s=d,u=D(),a=c(s.file?"/storage"+s.file.path:null),o=c(k(s.file?s.file.status:null)),p=c(s.file?s.file:null),_=b(),v=c(),$=c(!1),C=r=>{const n=r.target;if(n.files){const y=new FileReader;y.onload=f=>{m.value=f.target.result},y.readAsDataURL(n.files[0])}},m=c(null),E=async r=>{v.value=null;try{const n=["image/jpeg","image/png","image/webp","application/pdf"],f=r.target.files[0];if(!n.includes(f.type))throw alert("\u041D\u0435 \u043F\u0440\u0430\u0432\u0438\u043B\u044C\u043D\u044B\u0439 \u0444\u043E\u0440\u043C\u0430\u0442 \u0444\u0430\u0439\u043B\u0430. \u0418\u0441\u043F\u043E\u043B\u044C\u0437\u0443\u0439\u0442\u0435 JPEG, PNG, WEBP, \u0438\u043B\u0438 PDF"),new ValidationError("\u041D\u0435 \u043F\u0440\u0430\u0432\u0438\u043B\u044C\u043D\u044B\u0439 \u0444\u043E\u0440\u043C\u0430\u0442 \u0444\u0430\u0439\u043B\u0430. \u0418\u0441\u043F\u043E\u043B\u044C\u0437\u0443\u0439\u0442\u0435 JPEG, PNG, WEBP, \u0438\u043B\u0438 PDF");if(f.size>4194304)throw alert("\u0424\u0430\u0439\u043B \u0434\u043E\u043B\u0436\u0435\u043D \u0431\u044B\u0442\u044C \u043C\u0435\u043D\u044C\u0448\u0435 4\u041C\u0411"),new ValidationError("\u0424\u0430\u0439\u043B \u0434\u043E\u043B\u0436\u0435\u043D \u0431\u044B\u0442\u044C \u043C\u0435\u043D\u044C\u0448\u0435 4\u041C\u0411");C(r);const w=new FormData;w.append("file",f),w.append("type",s.document.type);const x=await axios.post(`/api/admin/user/${_.params.id}/file`,w,{headers:{"Content-Type":"multipart/form-data"}});m.value=null,a.value="/storage"+x.data.file.path,o.value=k("edit"),p.value=x.data.file}catch(n){console.log(n.message),v.value="\u041E\u0448\u0438\u0431\u043A\u0430 \u043F\u0440\u0438 \u0437\u0430\u0433\u0440\u0443\u0437\u043A\u0435 \u0444\u0430\u0439\u043B\u043E\u0432",m.value=null}},U=async()=>{try{(await axios.delete(`/api/admin/user/${_.params.id}/file/${s.document.type}`)).data.result===!0?(o.value=k(null),a.value=null):u.dispatch("notification/displayMessage",{value:"\u0424\u0430\u0439\u043B \u043D\u0435 \u0443\u0434\u0430\u043B\u0435\u043D",type:"error"})}catch(r){console.log(r.message)}};return(r,n)=>(t(),l("div",L,[e("h4",{onClick:n[0]||(n[0]=y=>$.value=!$.value)},i(s.document.title),1),e("div",{class:V(["upload-container",{"upload-container__show":$.value}])},[a.value?(t(),l("div",W,[e("div",H,[e("a",{href:a.value,target:"_blank"},[a.value.toLowerCase().includes("pdf")?(t(),l("i",j)):(t(),l("img",{key:1,src:a.value,alt:"image"},null,8,O))],8,M),p.value&&(p.value.status==="edit"||p.value.status==="cancel")?(t(),l("div",{key:0,class:"remove-img",onClick:U},X)):g("",!0)])])):(t(),l("div",q,[K,m.value?(t(),l("div",{key:1,class:"imagePreviewWrapper",style:N({"background-image":`url(${m.value})`})},te,4)):(t(),l("label",{key:0,for:`file-${s.document.type}`,class:"label-file"},ee,8,Y)),e("input",{type:"file",onChange:E,class:"file-input-hide",id:`file-${s.document.type}`},null,40,ae),v.value?(t(),l("div",le,i(v.value),1)):g("",!0)]))],2),e("div",ie," \u0421\u0442\u0430\u0442\u0443\u0441: "+i(o.value),1)]))}};const ne=d=>(R("data-v-ff62170a"),d=d(),T(),d),ce={class:"col-12"},re={class:"dashboard-item"},de=ne(()=>e("h3",null,"\u0414\u043E\u043A\u0443\u043C\u0435\u043D\u0442\u044B",-1)),ue={key:0,class:"file-container"},pe={__name:"UserFilesAdmin",setup(d){const s=c([{type:"studak",title:"\u0421\u0442\u0443\u0434\u0435\u043D\u0447\u0435\u0441\u043A\u0438\u0439/\u0414\u0438\u043F\u043B\u043E\u043C"},{type:"passport",title:"\u041F\u0430\u0441\u043F\u043E\u0440\u0442"},{type:"insurance",title:"\u0421\u0442\u0440\u0430\u0445\u043E\u0432\u043A\u0430"},{type:"license",title:"\u041F\u0440\u0430\u0432\u0430 \u043D\u0430 \u044F\u0445\u0442\u0443"},{type:"antidoping",title:"\u0421\u0435\u0440\u0442\u0435\u0444\u0438\u043A\u0430\u0442 \u0430\u043D\u0442\u0438\u0434\u043E\u043F\u0438\u043D\u0433\u0430"},{type:"1444",title:"\u0421\u043F\u0440\u0430\u0432\u0430\u043A\u0430 1444\u043D"},{type:"oms",title:"\u041E\u041C\u0421"},{type:"category",title:"\u0420\u0430\u0437\u0440\u044F\u0434"},{type:"vfps",title:"\u0427\u0435\u043B\u0435\u043D\u0441\u0442\u0432\u043E \u0412\u0424\u041F\u0421"},{type:"permit",title:"\u0421\u043E\u0433\u043B\u0430\u0441\u0438\u0435 \u043D\u0430 \u043E\u0431\u0440\u0430\u0431\u043E\u0442\u043A\u0443 \u0434\u0430\u043D\u043D\u044B\u0445"}]),u=c(null),a=b();return P(async()=>{const o=await axios.get(`/api/admin/user/${a.params.id}/docs`);u.value=o.data.files}),(o,p)=>(t(),l("div",ce,[e("div",re,[de,u.value?(t(),l("div",ue,[(t(!0),l(A,null,G(s.value,_=>(t(),I(oe,{document:_,file:u.value.find(v=>v.type===_.type),key:_.type},null,8,["document","file"]))),128))])):g("",!0)])]))}},_e=z(pe,[["__scopeId","data-v-ff62170a"]]),ve={class:"container-fluid g-0"},me={class:"row"},fe={class:"col-12"},he={class:"dashboard-item"},ye={class:"user-account__data"},ge={class:"b500"},$e={class:"b500"},we={key:0},ke={class:"b500"},be={class:"dashboard-item"},Ae={__name:"user",setup(d){const s=c({}),u=b();return P(async()=>{try{const a=await F.get(`/api/admin/user/${u.params.id}`);s.value=a.data;const o=await F.get("/api/universities");s.value.university=o.data.find(p=>p.code===a.data.university_id).label}catch(a){console.log(a.message)}}),(a,o)=>(t(),l(A,null,[S(B,null,{default:J(()=>[h("\u041F\u043E\u043B\u044C\u0437\u043E\u0432\u0430\u0442\u0435\u043B\u044C: "+i(s.value.surname)+" "+i(s.value.name)+" "+i(s.value.patronymic),1)]),_:1}),e("main",null,[e("div",ve,[e("div",me,[e("div",fe,[e("div",he,[e("div",ye,[e("p",null,[h("\u0424\u0418\u041E: "),e("span",ge,i(s.value.surname)+" "+i(s.value.name)+" "+i(s.value.patronymic),1)]),e("p",null,[h("E-mail: "),e("span",$e,i(s.value.email),1)]),s.value.university?(t(),l("p",we,[h("\u0423\u043D\u0438\u0432\u0435\u0440\u0441\u0438\u0442\u0435\u0442: "),e("span",ke,i(s.value.university),1)])):g("",!0)])]),e("div",be,[S(_e)])])])])])],64))}};export{Ae as default};
